#Intelligent defect classification system based on deep learning

##製造工程における欠陥画像を製造プロセス向上に生かせるか？~SORAサクライ　櫻井　敏明
===

Submitted on 2018/02



http://journals.sagepub.com/doi/pdf/10.1177/1687814018766682


---

#どんなもの？

## 背景

* 今回、光学系CCDカメラ（AOI）で製品の欠陥を見つける環境がある。
* しかし、それを自己学習によって品質改善につなげる手法ができていない。
* 欠陥を分類、即時に評価して、製造プロセスへフィードバックするゆにしたい。

(前回の検査対象は金属キズ↓)

![例](https://image.ibb.co/dd5kM7/scratch01.jpg)

(今回はコレ↓　タッチパネルグラスの表面検査)

![例](https://image.ibb.co/iUAmhy/input_Image_4_201806.jpg)


## 動機

* ガラス表面の品質検査では現在AOIが使われ、走査スピードも速く画像量も多い。
* 画像分析を素早く正確に行い、即時に欠陥の種類を分類したい。→GPU（GTX 1080）を使う

　
（以下のAOIでタッチパネルグラスの表面を検査する。）


<img src="https://image.ibb.co/cBLPYT/input_Image_2_201806.jpg" width="540" height="330" />



---

## どうやって有効だと検証した？


* ニューラルネットワークはZF-Net をベースに、5層の畳み込み＋2層の結合層から成る。
* 4000サンプルでトレーニングを実施。11種類の欠陥に分類。


<img src="https://image.ibb.co/gufmf8/input_Image201806.jpg" width="900" height="600" />




* 実験の結果、以下のように検出した欠陥にラベル付けすることができた。

![例](https://image.ibb.co/cAkBf8/input_Image_3_201806.jpg)

## 技術や手法の肝は？


* GTX 1080を使って、2秒で16115枚の写真データをカテゴリ分けできた。
* AOIの走査時間が　65,536の画像に7秒かかる計算なので、カテゴリ分けの速度は十分満足できる。
* バブル、スクラッチの精度は100%。ただし表面の傾斜は96％の精度。


![例](https://image.ibb.co/c9LV9d/input_Image_5_201806.jpg)

※発生率10％未満のカテゴリについてはマイナーな問題としてカテゴリ分けから外した。

※どこまで欠陥とするかはユーザの仕様やルールによるため。


---

---

## 議論はある？


* 検査で欠陥の自動分類ができれば、発生頻度、発生時期と合わせて生産サイドにフィードバックする道筋はできる。

* ただし何を欠陥とするか、許容はどこまでか、良否判定が明確でない。結局そこは人の目視に頼らざるを得ない。

* 大量自動生産の環境下での自動検査を前提としている。大手製造業には適する。小さい企業には無理。







---

## 次に読むべき論文は？

製造現場、特に品質検査系を引き続き探します。